<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>地域フォルダ管理</title>

<style>
body{
    font-family: sans-serif;
    margin:0;
    padding:10px;
    background:#f5f5f5;
}

h1{
    text-align:center;
}

.region{
    margin-top:15px;
}

.region-title{
    font-size:18px;
    font-weight:bold;
    padding:10px;
    background:#d0e8ff;
    border-radius:8px;
}

.folder{
    margin:5px 0;
}

.pref-title{
    background:white;
    padding:10px;
    border-radius:8px;
}

.subArea{
    margin-left:15px;
    display:none;
}

.subfolder{
    background:#e3f2fd;
    padding:8px;
    margin:5px 0;
    border-radius:8px;
}

button{
    padding:8px;
    margin-top:5px;
    width:100%;
}

img{
    width:100%;
    margin-top:5px;
    border-radius:6px;
}

.hidden{
    display:none;
}
</style>
</head>
<body>

<h1>ポケふた</h1>
<div id="area"></div>

<input type="file" id="imageInput" accept="image/*" class="hidden">

<script>

const regions = {
    "北海道・東北": ["北海道","青森","岩手","宮城","秋田","山形","福島"],
    "関東": ["茨城","栃木","群馬","埼玉","千葉","東京","神奈川"],
    "中部": ["新潟","富山","石川","福井","山梨","長野","岐阜","静岡","愛知"],
    "近畿": ["三重","滋賀","京都","大阪","兵庫","奈良","和歌山"],
    "中国・四国": ["鳥取","島根","岡山","広島","山口","徳島","香川","愛媛","高知"],
    "九州・沖縄": ["福岡","佐賀","長崎","熊本","大分","宮崎","鹿児島","沖縄"]
};

let selectedSubFolder = null;

// ---------------------
// 初期生成
// ---------------------
function init(){
    const areaDiv = document.getElementById("area");

    for(const region in regions){

        const regionDiv = document.createElement("div");
        regionDiv.className = "region";

        const regionTitle = document.createElement("div");
        regionTitle.className = "region-title";
        regionTitle.textContent = "▶ " + region;

        const regionContent = document.createElement("div");
        regionContent.style.display = "none";

        regionTitle.onclick = function(){
            if(regionContent.style.display === "none"){
                regionContent.style.display = "block";
                regionTitle.textContent = "▼ " + region;
            }else{
                regionContent.style.display = "none";
                regionTitle.textContent = "▶ " + region;
            }
        };

        regions[region].forEach(pref => {
            const folder = document.createElement("div");
            folder.className = "folder";

            const prefTitle = document.createElement("div");
            prefTitle.className = "pref-title";
            prefTitle.textContent = "▶ " + pref;

            const prefContent = document.createElement("div");
            prefContent.className = "subArea";

            prefTitle.onclick = function(){
                if(prefContent.style.display === "none"){
                    prefContent.style.display = "block";
                    prefTitle.textContent = "▼ " + pref;
                }else{
                    prefContent.style.display = "none";
                    prefTitle.textContent = "▶ " + pref;
                }
            };

            prefContent.innerHTML = `
                <button onclick="addSubFolder(this)">サブフォルダ追加</button>
                <div class="subArea-inner"></div>
            `;

            folder.appendChild(prefTitle);
            folder.appendChild(prefContent);
            regionContent.appendChild(folder);
        });

        regionDiv.appendChild(regionTitle);
        regionDiv.appendChild(regionContent);
        areaDiv.appendChild(regionDiv);
    }
}

window.onload = init;

// ---------------------
// サブフォルダ追加
// ---------------------
function addSubFolder(btn){
    const name = prompt("サブフォルダ名を入力");
    if(!name) return;

    const sub = document.createElement("div");
    sub.className = "subfolder";
    sub.innerHTML = `
        <span>${name}</span>
        <button onclick="addPhoto(this)">写真</button>
        <div class="imageArea"></div>
    `;

    let pressTimer;

    sub.addEventListener("touchstart", startPress);
    sub.addEventListener("mousedown", startPress);

    sub.addEventListener("touchend", cancelPress);
    sub.addEventListener("mouseup", cancelPress);
    sub.addEventListener("mouseleave", cancelPress);

    function startPress(){
        pressTimer = setTimeout(()=>{
            if(confirm("このサブフォルダを削除しますか？")){
                sub.remove();
            }
        },1000);
    }

    function cancelPress(){
        clearTimeout(pressTimer);
    }

    btn.parentElement.querySelector(".subArea-inner").appendChild(sub);
}

// ---------------------
// 写真追加
// ---------------------
function addPhoto(btn){
    selectedSubFolder = btn.parentElement.querySelector(".imageArea");
    document.getElementById("imageInput").click();
}

document.getElementById("imageInput").addEventListener("change",function(){
    const file = this.files[0];
    if(!file) return;

    const reader = new FileReader();
    reader.onload = function(e){
        const img = document.createElement("img");
        img.src = e.target.result;
        selectedSubFolder.appendChild(img);
    }
    reader.readAsDataURL(file);
});

</script>

</body>
</html>