<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†</title>

<style>
body{
    font-family: sans-serif;
    margin:0;
    padding:10px;
    background:#f5f5f5;
}

button{
    padding:10px;
    margin:5px 0;
    width:100%;
    font-size:16px;
}

.folder{
    background:white;
    padding:10px;
    margin:5px 0;
    border-radius:8px;
}

.subfolder{
    background:#e3f2fd;
    padding:8px;
    margin:5px 0 5px 20px;
    border-radius:8px;
}

img{
    width:100%;
    margin-top:5px;
    border-radius:6px;
}

.hidden{
    display:none;
}
</style>
</head>
<body>

<h2>éƒ½é“åºœçœŒãƒ•ã‚©ãƒ«ãƒ€</h2>

<div id="folderArea"></div>

<button onclick="addPrefecture()">éƒ½é“åºœçœŒã‚’è¿½åŠ </button>

<input type="file" id="imageInput" accept="image/*" class="hidden">

<script>
let selectedSubFolder = null;

// ---------------------
// éƒ½é“åºœçœŒè¿½åŠ 
// ---------------------
function addPrefecture(){
    const name = prompt("éƒ½é“åºœçœŒåã‚’å…¥åŠ›");
    if(!name) return;

    const div = document.createElement("div");
    div.className = "folder";
    div.innerHTML = `
        <strong>${name}</strong>
        <button onclick="addSubFolder(this)">ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€è¿½åŠ </button>
        <div class="subArea"></div>
    `;
    document.getElementById("folderArea").appendChild(div);
}

// ---------------------
// ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€è¿½åŠ 
// ---------------------
function addSubFolder(btn){
    const name = prompt("ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€åã‚’å…¥åŠ›");
    if(!name) return;

    const sub = document.createElement("div");
    sub.className = "subfolder";
    sub.innerHTML = `
        <span>${name}</span>
        <button onclick="addPhoto(this)">å†™çœŸ</button>
        <div class="imageArea"></div>
    `;

    // ğŸ”´ é•·æŠ¼ã—å‰Šé™¤ï¼ˆ1ç§’ï¼‰
    let pressTimer;
    sub.addEventListener("touchstart", startPress);
    sub.addEventListener("mousedown", startPress);

    sub.addEventListener("touchend", cancelPress);
    sub.addEventListener("mouseup", cancelPress);
    sub.addEventListener("mouseleave", cancelPress);

    function startPress(){
        pressTimer = setTimeout(()=>{
            if(confirm("ã“ã®ã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")){
                sub.remove();
            }
        },1000);
    }

    function cancelPress(){
        clearTimeout(pressTimer);
    }

    btn.parentElement.querySelector(".subArea").appendChild(sub);
}

// ---------------------
// å†™çœŸè¿½åŠ ï¼ˆã‚µãƒ–ãƒ•ã‚©ãƒ«ãƒ€ã®ã¿ï¼‰
// ---------------------
function addPhoto(btn){
    selectedSubFolder = btn.parentElement.querySelector(".imageArea");
    document.getElementById("imageInput").click();
}

document.getElementById("imageInput").addEventListener("change",function(){
    const file = this.files[0];
    if(!file) return;

    const reader = new FileReader();
    reader.onload = function(e){
        const img = document.createElement("img");
        img.src = e.target.result;
        selectedSubFolder.appendChild(img);
    }
    reader.readAsDataURL(file);
});
</script>

</body>
</html>