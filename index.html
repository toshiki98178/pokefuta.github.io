<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åœ°åŸŸãƒ•ã‚©ãƒ«ãƒ€</title>
<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont;
  background:#f2f2f7;
}
.header{
  position:sticky;
  top:0;
  background:white;
  padding:15px;
  font-weight:600;
  border-bottom:1px solid #ddd;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.header-right{
  display:flex;
  gap:8px;
}
.list{
  background:white;
}
.item{
  padding:16px;
  border-bottom:1px solid #eee;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.item:active{
  background:#e5e5ea;
}
button{
  background:#007aff;
  color:white;
  border:none;
  padding:8px 12px;
  border-radius:8px;
}
button.hidden{
  display:none;
}
.back{
  color:#007aff;
  background:none;
}
.delete-btn{
  background:#ff3b30;
}
img{
  width:60px;
  height:60px;
  object-fit:cover;
  border-radius:8px;
}
</style>
</head>
<body>

<div class="header">
  <button class="back" onclick="goBack()">â†</button>
  <div id="title">æ—¥æœ¬</div>
  <div class="header-right">
    <button id="photoBtn" onclick="triggerPhoto()">ğŸ“·</button>
    <button id="addBtn" onclick="addFolder()">ï¼‹</button>
  </div>
</div>

<div class="list" id="list"></div>

<input type="file" id="fileInput" accept="image/*" style="display:none" onchange="addImage(event)">

<script>
let stack=[];
let data=JSON.parse(localStorage.getItem("folderData"))||createInitialData();
let current=data;

function createInitialData(){
  const structure={
    "åŒ—æµ·é“ãƒ»æ±åŒ—":["åŒ—æµ·é“","é’æ£®çœŒ","å²©æ‰‹çœŒ","å®®åŸçœŒ","ç§‹ç”°çœŒ","å±±å½¢çœŒ","ç¦å³¶çœŒ"],
    "é–¢æ±":["èŒ¨åŸçœŒ","æ ƒæœ¨çœŒ","ç¾¤é¦¬çœŒ","åŸ¼ç‰çœŒ","åƒè‘‰çœŒ","æ±äº¬éƒ½","ç¥å¥ˆå·çœŒ"],
    "ä¸­éƒ¨":["æ–°æ½ŸçœŒ","å¯Œå±±çœŒ","çŸ³å·çœŒ","ç¦äº•çœŒ","å±±æ¢¨çœŒ","é•·é‡çœŒ","å²é˜œçœŒ","é™å²¡çœŒ","æ„›çŸ¥çœŒ"],
    "è¿‘ç•¿":["ä¸‰é‡çœŒ","æ»‹è³€çœŒ","äº¬éƒ½åºœ","å¤§é˜ªåºœ","å…µåº«çœŒ","å¥ˆè‰¯çœŒ","å’Œæ­Œå±±çœŒ"],
    "ä¸­å›½ãƒ»å››å›½":["é³¥å–çœŒ","å³¶æ ¹çœŒ","å²¡å±±çœŒ","åºƒå³¶çœŒ","å±±å£çœŒ","å¾³å³¶çœŒ","é¦™å·çœŒ","æ„›åª›çœŒ","é«˜çŸ¥çœŒ"],
    "ä¹å·ãƒ»æ²–ç¸„":["ç¦å²¡çœŒ","ä½è³€çœŒ","é•·å´çœŒ","ç†Šæœ¬çœŒ","å¤§åˆ†çœŒ","å®®å´çœŒ","é¹¿å…å³¶çœŒ","æ²–ç¸„çœŒ"]
  };

  let root={name:"æ—¥æœ¬",children:[],images:[],locked:true,allowImage:false};

  for(let region in structure){
    let regionFolder={name:region,children:[],images:[],locked:true,allowImage:false};

    structure[region].forEach(pref=>{
      regionFolder.children.push({
        name:pref,
        children:[],
        images:[],
        locked:false,
        allowImage:false
      });
    });

    root.children.push(regionFolder);
  }
  return root;
}

function render(){
  document.getElementById("title").innerText=current.name;

  const addBtn=document.getElementById("addBtn");
  const photoBtn=document.getElementById("photoBtn");

  addBtn.classList.toggle("hidden", current.locked);
  photoBtn.classList.toggle("hidden", !current.allowImage);

  let list=document.getElementById("list");
  list.innerHTML="";

  current.children?.forEach((folder,index)=>{
    let div=document.createElement("div");
    div.className="item";

    let left=document.createElement("span");
    left.textContent=folder.name;

    let right=document.createElement("div");
    right.style.display="flex";
    right.style.gap="8px";

    let arrow=document.createElement("span");
    arrow.textContent=">";

    right.appendChild(arrow);

    if(!folder.locked){
      let del=document.createElement("button");
      del.textContent="å‰Šé™¤";
      del.className="delete-btn";
      del.onclick=(e)=>{
        e.stopPropagation();
        if(confirm("ã“ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")){
          current.children.splice(index,1);
          save();
          render();
        }
      };
      right.appendChild(del);
    }

    div.appendChild(left);
    div.appendChild(right);

    div.onclick=()=>{
      stack.push(current);
      current=folder;
      render();
    };

    list.appendChild(div);
  });

  current.images?.forEach((img,i)=>{
    let div=document.createElement("div");
    div.className="item";

    let image=document.createElement("img");
    image.src=img;

    let del=document.createElement("button");
    del.textContent="å‰Šé™¤";
    del.className="delete-btn";
    del.onclick=()=>{
      current.images.splice(i,1);
      save();
      render();
    };

    div.appendChild(image);
    div.appendChild(del);

    list.appendChild(div);
  });
}

function addFolder(){
  if(current.locked)return;

  let name=prompt("ãƒ•ã‚©ãƒ«ãƒ€å");
  if(!name)return;

  current.children.push({
    name:name,
    children:[],
    images:[],
    locked:false,
    allowImage:true
  });

  save();
  render();
}

function triggerPhoto(){
  document.getElementById("fileInput").click();
}

function addImage(e){
  let file=e.target.files[0];
  if(!file)return;

  let reader=new FileReader();
  reader.onload=function(evt){
    current.images.push(evt.target.result);
    save();
    render();
  };
  reader.readAsDataURL(file);
}

function goBack(){
  if(stack.length>0){
    current=stack.pop();
    render();
  }
}

function save(){
  localStorage.setItem("folderData",JSON.stringify(data));
}

render();
</script>

</body>
</html>